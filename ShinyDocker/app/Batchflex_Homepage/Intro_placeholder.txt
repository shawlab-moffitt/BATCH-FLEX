BatchFLEX provides four significant methods of batch evaluation, which can be categorized into 1) unsupervised analysis, 2) vari-ance analysis of known batch effects, 3) estimating unknown batch effects, and 4) comparative expression analysis. Unsupervised analysis includes dimension reduction into low dimensions and clustering. The data can be visualized in principal components via PCA, which can be annotated by assigning color to any factor of interest. BatchFLEX also generates a table displaying the contribu-tion of variance by each factor. BatchFLEX performs cluster anal-ysis of k-means generated clusters using Elbow, Silhouette, and Dunn plots. These analyses can help users determine if the optimal number of clusters and whether the clusters correlate well with the biological variable of interest. Next, the variance analysis of known batch effects examines the variation contributed by anno-tated technical factors, such as study type, platform, and sequenc-ing type. BatchFLEX provides two major functions for this as-sessment: relative log expression plots and explanatory variable plots. Users can organize the data according to known technical factors and visualize unwanted variation from the batch effect using the sample-wise relative log expression plot. The explanato-ry variables and density analysis are included to assess whether each gene is associated more with the batch effect or the variable of interest by displaying the distribution of R-squared values across all genes for each user-selected variable. Batch estimation is performed with surrogate variable analysis to identify hidden batch effects by inferring latent variables in orthogonal space (Leek and Storey, 2007). BatchFLEX then provides the posterior probability that each gene is associated with the latent variable implemented in the SVA package. Additionally, BatchFLEX can determine the impact of a batch effect or biological variable of interest at an individual gene level using a boxplot and using statis-tical measures of significance from the Wilcoxon rank-sum test, the t-test, the Kruskal Wallis test, or ANOVA. The boxplot and RLE plot also allow users to assess if outliers are present at a sample level or a gene level. Each of these methods of visualiza-tion and statistical analysis helps the user assess if the batch effect is significant and if correction is necessary. Moreover, BatchFLEX provides real-time immune deconvolution by ImmDeconv (Sturm, et al., 2020) and single-sample Pathway analysis as implemented in GSVA (Hanzelmann, et al., 2013). Each analysis is rendered side-by-side for easy comparison. Users can easily switch between batch correction methods, allowing on-the-fly comparisons of batch correction methods to ensure that the most optimal method is chosen for a particular dataset. The output can easily export the updated matrix for downstream analysis and any desired diagnos-tic can then be downloaded as a single ZIP file.
